---
pagetitle: "Summary Statistics"
editor: source
format: 
  revealjs:
    chalkboard: true
    incremental: true
    theme: [default, custom.scss]
    height: 900
    width: 1600
    slide-number: c
    auto-stretch: false
    callout-appearance: simple
    pdf-max-pages-per-slide: 2
    menu: 
      side: right
      numbers: true
html: 
  math-method: katex
execute:
  echo: true
  warning: false
  message: false
---

```{r}
#| include: false
#| warning: false
#| message: false

knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, 
                      fig.retina = 3, fig.align = 'center')
library(knitr)
library(ggplot2)
library(dplyr)
```

::::: columns
::: {.column .center width="60%"}
![](img/DAW.jpeg){width="90%"}
:::

::: {.column .center width="40%"}
<br>

[Summary Statistics]{.custom-title}

<br> <br> <br> <br> <br>

[Megan Ayers]{.custom-subtitle}

[Math 141 \| Spring 2026 <br> Monday, Week 2]{.custom-subtitle}
:::
:::::

------------------------------------------------------------------------


## Announcements

::: {.nonincremental}
-   The teaching team would love to see you in office hours!
    -   **Megan's office hours**: For individual or small group help on problems or concepts
    -   **Course assistant office hours**: To work on assignments with your peers and get help from the course assistants when you are stuck
:::

::: fragment
-  Reminder: If you haven't already, make sure your access to Gradescope is set up.
-  Please select pages for each problem part on Gradescope
:::

```{r, echo = FALSE, eval = FALSE}

qod <- read.csv("data/qod-music.csv")
qod$Section <- substr(qod$Section, 3, 3)
qod %>% 
  ggplot(aes(y = Section, fill = Cleaned)) +
  geom_bar(position = "fill") +
  ggtitle("Should we play music in lab?") +
  theme_classic()


table(qod$Section[qod$Notes!= ""], qod$Notes[qod$Notes!= ""])

```

------------------------------------------------------------------------

### Last Time

::: nonincremental
-   Learned about the structure of `ggplot2`
-   Learn five standard graphs for numerical/quantitative data: histograms, boxplots, barplots, scatterplots, and linegraphs
:::

### Goals for Today

-   Consider measures for **summarizing** quantitative data
    -   Center
    -   Spread/variability
-   Consider measures for **summarizing** categorical data
    - Contingency tables


------------------------------------------------------------------------

## Import the Data

```{r}
biketown <- read.csv("data/biketown.csv")

# Inspect the data
str(biketown)
```

------------------------------------------------------------------------

## Summarizing Data

```{r, echo = FALSE}
library(kableExtra)
biketown[25:33,
         c("RouteID", "PaymentPlan", "StartHub", "Distance_Miles")] %>%
  knitr::kable() %>%
  kable_styling(bootstrap_options = c("responsive", "bordered", "striped")) 
```

-   Hard to do by eyeballing a spreadsheet with many rows!

------------------------------------------------------------------------

## Summarizing Data Visually

::::: columns
::: {.column width="50%"}
```{r, echo = FALSE}
# Create histogram
ggplot(data = biketown, mapping = aes(x = Distance_Miles)) + 
  geom_histogram(fill = "slateblue4", color = "ghostwhite") +
  facet_wrap(~PaymentPlan, ncol = 1)

```
:::

::: {.column width="50%"}
<br>

For a quantitative variable, often want to answer:

-   What is an **average** value?

-   What is the **trend/shape** of the variable?

-   How much **variation** is there from case to case?
:::
:::::

::: fragment
Need to learn key **summary statistics**: Numerical values computed based on the observed cases.
:::

------------------------------------------------------------------------

## Measures of Center

::::: columns
::: {.column width="50%"}
**Mean**: Average of all the observations

-   $n$ = Number of cases (sample size)
-   $x_i$ = value of the i-th observation
-   Denote by $\bar{x}$

:::

::: {.column width="50%" .nonincrmental}

:::
:::::

------------------------------------------------------------------------

## Measures of Center

::::: columns
::: {.column width="50%" .nonincremental}
**Mean**: Average of all the observations

-   $n$ = Number of cases (sample size)
-   $x_i$ = value of the i-th observation
-   Denote by $\bar{x}$

$$
\bar{x}  = \frac{1}{n} \sum_{i = 1}^n x_i
$$


:::

::: {.column width="50%" .nonincremental}

:::
:::::

------------------------------------------------------------------------

## Measures of Center

::::: columns
::: {.column width="50%" .nonincremental}
**Mean**: Average of all the observations

-   $n$ = Number of cases (sample size)
-   $x_i$ = value of the i-th observation
-   Denote by $\bar{x}$

$$
\bar{x}  = \frac{1}{n} \sum_{i = 1}^n x_i
$$
:::

::: {.column width="50%"}

::: fragment
```{r}
# Test out on first 6 values
head(biketown$Distance_Miles)
```
:::

<br>

::: fragment
```{r}
(1.91 + 0.72 + 3.42 + 1.81 + 4.51 + 5.54) / 6
```

:::

<br>

::: fragment
```{r}
# Compute in R for all values
mean(biketown$Distance_Miles)
```
:::
:::
:::::

------------------------------------------------------------------------

## Measures of Center

::::: columns
::: {.column width="50%"}
**Median**: Middle value

-   Half of the data falls below the median
-   Denote by $m$
-   If $n$ is even, then it is the average of the middle two values

:::

::: {.column width="50%" .nonincremental}

:::
:::::

------------------------------------------------------------------------

## Measures of Center

::::: columns
::: {.column width="50%" .nonincremental}
**Median**: Middle value

-   Half of the data falls below the median
-   Denote by $m$
-   If $n$ is even, then it is the average of the middle two values

```{r}
# Test out on first 6 values
head(biketown$Distance_Miles)
```

<br>

::: fragment

```{r}
sort(head(biketown$Distance_Miles))
```

:::

<br>

::: fragment
```{r}
(3.42 + 1.91) / 2
```

:::

:::

::: {.column .fragment width="50%"}
Compute in R:

```{r}
median(biketown$Distance_Miles)
```
:::
:::::

------------------------------------------------------------------------

## Measures of Center

::::: columns
::: {.column width="50%" .nonincremental}
Why is the mean larger than the median?

```{r}
data.frame(mean_miles = mean(biketown$Distance_Miles),
           median_miles = median(biketown$Distance_Miles))
```
:::

::: {.column .fragment width="50%"}
```{r, echo = FALSE}
# Create histogram
ggplot(data = biketown, mapping = aes(x = Distance_Miles)) + 
  geom_histogram(fill = "slateblue4", color = "ghostwhite") 
```
:::
:::::


::: fragment

Answer: the distribution is **skewed**. In skewed distributions, the mean is pulled farther in the direction of skew than the median.

:::


------------------------------------------------------------------------

## Measures of Center

**Note**: The mean is very sensitive to outliers, while the median is not.

```{r}
my_data <- c(1, 2, 5, 7, 8, 10)
my_data_with_outlier <- c(1, 2, 5, 7, 8, 100)
```

<br><br>

::::::: fragment
::::: columns
::: {.column width="50%"}

```{r}
mean(my_data)
```

:::

::: {.column width="50%"}

```{r}
mean(my_data_with_outlier)
```


:::

:::::
:::::::

<br><br>

::::::: fragment
::::: columns
::: {.column width="50%"}

```{r}
median(my_data)
```

:::

::: {.column width="50%"}

```{r}
median(my_data_with_outlier)
```


:::

:::::

:::::::

<br>

::: fragment

We call the median a **robust** statistic.

:::

------------------------------------------------------------------------

## Computing Measures of Center by Groups

**Question**: Who travels further, on average? Casual biketown users or payment plan subscribers?

```{r, echo = FALSE}
#| fig-width: 10

# Create histogram
ggplot(data = biketown, mapping = aes(x = Distance_Miles)) + 
  geom_histogram(fill = "slateblue4", color = "ghostwhite") +
  facet_wrap(~PaymentPlan, ncol = 1)

```

------------------------------------------------------------------------

## Computing Measures of Center by Groups

::::: columns
::: {.column width="50%"}

Handy `dplyr` functions that we'll learn: `group_by()` and `summarize()`.

::: fragment
```{r}

library(dplyr)

# Calculate group *MEANS*
biketown %>%
  group_by(PaymentPlan) %>%
  summarize(mean_dist = mean(Distance_Miles))
  

```
:::

<br>

::: fragment
```{r}

# Calculate group *MEDIANS*
biketown %>%
  group_by(PaymentPlan) %>%
  summarize(median_dist = median(Distance_Miles))

```
:::
:::

::: {.column width="50%"}
```{r, echo = FALSE}
# Create histogram
ggplot(data = biketown, mapping = aes(x = Distance_Miles)) + 
  geom_histogram(fill = "slateblue4", color = "ghostwhite") +
  facet_wrap(~PaymentPlan, ncol = 1) +
  theme(strip.text = element_text(size = 16))  # Increase title size
```
:::
:::::


------------------------------------------------------------------------

## Measures of Variability

-   Want a statistic that captures how much observations **deviate** from the mean

::::: columns
::: {.column width="50%"}
-   Find how much each observation deviates from the mean.
-   Idea: Compute the average of the deviations

:::

::: {.column width="50%" .nonincremental}

:::
:::::



------------------------------------------------------------------------

## Measures of Variability

::: {.nonincremental}

-   Want a statistic that captures how much observations **deviate** from the mean

:::

::::: columns
::: {.column width="50%" .nonincremental}
-   Find how much each observation deviates from the mean.
-   Idea: Compute the average of the deviations

$$
\frac{1}{n} \sum_{i = 1}^n (x_i - \bar{x})
$$
:::

::: {.column width="50%"}

:::
:::::



------------------------------------------------------------------------


## Measures of Variability

::: {.nonincremental}

-   Want a statistic that captures how much observations **deviate** from the mean

:::

::::: columns
::: {.column width="50%" .nonincremental}
-   Find how much each observation deviates from the mean.
-   Idea: Compute the average of the deviations

$$
\frac{1}{n} \sum_{i = 1}^n (x_i - \bar{x})
$$
:::

::: {.column width="50%"}
```{r}
# Test out on first 6 values
head(biketown$Distance_Miles)
```
:::
:::::

::: fragment
**Problem?**
:::

:::: columns
::: {.column width=50%}
::: fragment
```{r}
# Calculate mean by hand
(1.91 + 0.72 + 3.42 + 1.81 + 4.51 + 5.54) / 6
```
:::
:::

::: {.column width=50%}
::: fragment
```{r}
# Calculate average deviations by hand
((1.91 - 2.985) + (0.72 - 2.985) + 
  (3.42 - 2.985) + (1.81 - 2.985) +
  (4.51 - 2.985) + (5.54 - 2.985)) / 6
```
:::
:::
:::::

------------------------------------------------------------------------

## Measures of Variability

::: {.nonincremental}

-   Want a statistic that captures how much observations **deviate** from the mean

:::

::::: columns
::: {.column width="50%"}
**NEW** proposal:

-   Find how much each observation deviates from the mean.
-   Compute the average of the **squared** deviations.
:::

::: {.column width="50%" .nonincremental}

:::
:::::

------------------------------------------------------------------------

## Measures of Variability

::: {.nonincremental}

-   Want a statistic that captures how much observations **deviate** from the mean

:::

::::: columns
::: {.column width="50%" .nonincremental}
**NEW** proposal:

-   Find how much each observation deviates from the mean.
-   Compute the average of the **squared** deviations.
:::

::: {.column width="50%"}
```{r}
# Test out on first 6 values
head(biketown$Distance_Miles)
```
:::
:::::

<br>

:::: columns
::: {.column width=50%}
::: fragment
```{r}
# Calculate mean by hand
(1.91 + 0.72 + 3.42 + 1.81 + 4.51 + 5.54) / 6
```
:::
:::

::: {.column width=50%}
::: fragment
```{r}
# Calculate average deviations by hand
((1.91 - 2.985)^2 + (0.72 - 2.985)^2 + 
  (3.42 - 2.985)^2 + (1.81 - 2.985)^2 +
  (4.51 - 2.985)^2 + (5.54 - 2.985)^2) / 6
```
:::
:::
:::::

------------------------------------------------------------------------

## Measures of Variability

::: {.nonincremental}

-   Want a statistic that captures how much observations **deviate** from the mean

:::

::::: columns
::: {.column width="50%"}
**NEW** proposal, formula:

-   Find how much each observation deviates from the mean.
-   Compute the (nearly) average of the **squared** deviations.
-   Called **sample variance** $s^2$.


:::

::: {.column width="50%" .nonincremental}

:::
:::::

------------------------------------------------------------------------

## Measures of Variability

::: {.nonincremental}

-   Want a statistic that captures how much observations **deviate** from the mean

:::

::::: columns
::: {.column width="50%" .nonincremental}
**NEW** proposal, formula:

-   Find how much each observation deviates from the mean.
-   Compute the (nearly) average of the **squared** deviations.
-   Called **sample variance** $s^2$.

$$
s^2 = \frac{1}{n - 1} \sum_{i = 1}^n (x_i - \bar{x})^2
$$
:::

::: {.column width="50%" .nonincremental}

:::
:::::

------------------------------------------------------------------------

## Measures of Variability

::: {.nonincremental}

-   Want a statistic that captures how much observations **deviate** from the mean

:::

::::: columns
::: {.column width="50%" .nonincremental}
**NEW** proposal, formula:

-   Find how much each observation deviates from the mean.
-   Compute the (nearly) average of the **squared** deviations.
-   Called **sample variance** $s^2$.

$$
s^2 = \frac{1}{n - 1} \sum_{i = 1}^n (x_i - \bar{x})^2
$$
:::

::: {.column width="50%"}
Compute with R:

```{r}
var(biketown$Distance_Miles)
```
:::
:::::

------------------------------------------------------------------------

## Measures of Variability

::: {.nonincremental}

-   Want a statistic that captures how much observations **deviate** from the mean

:::

::::: columns
::: {.column width="50%"}
::: {.nonincremental .fragment}
-   Find how much each observation deviates from the mean.
-   Compute the (nearly) average of the **squared** deviations ($s^2$).
-   Because observations are squared, units differ from original data.
:::
::: {.nonincremental .fragment}
-   The square root of the sample variance is called the **sample standard deviation** $s$.

![](img/sample_var_latex.png){width="65%"}

:::
:::

::: {.column width="50%" .nonincremental}
::: fragment
Compute in R:

```{r}
var(biketown$Distance_Miles)  # Variance
```

<br>

```{r}
sd(biketown$Distance_Miles)   # Standard deviation 
```

:::

<br>

::: fragment
```{r}
sqrt(var(biketown$Distance_Miles))
```
:::
:::
::::: 

------------------------------------------------------------------------

## Visualizing Standard Deviation

-   The standard deviation measures the **typical size of deviations from the mean.**
-   For most data sets, the large majority of observations are within 2 standard deviations of the mean.

::: fragment
```{r}
sd(biketown$Distance_Miles)
```

```{r fig.height = 2, out.width = "70%", fig.asp=.45, echo = F}
s <- sd(biketown$Distance_Miles)
mu <- mean(biketown$Distance_Miles)
(gg1 <- ggplot(biketown, aes(x = Distance_Miles)) +
  geom_histogram(bins = 50, color = "white") +
  geom_vline(xintercept = mu, color = "magenta3", linewidth = 1) +
  geom_vline(xintercept = mu+s, color = "dodgerblue", linewidth = .5) +
  geom_vline(xintercept = mu+2*s, color = "dodgerblue", linewidth = .5) +
  geom_vline(xintercept = mu-s, color = "dodgerblue", linewidth = .5) +
  geom_vline(xintercept = mu-2*s, color = "dodgerblue", linewidth = .5) +
  annotate("rect", xmin = mu-2*s, xmax =  mu+2*s, ymin = 0, ymax = 2250,
           alpha = .3, fill = "dodgerblue") +
  annotate(geom= "label",x = mu, y = 200, label = "Mean") +
  annotate(geom= "label",x = mu+2*s, y = 1100, label = "Mean + 2*s") +
  annotate(geom= "label",x = mu+s, y = 1100, label = "Mean + s") +
  annotate(geom= "label",x = mu-s, y = 1100, label = "Mean - s") +
  annotate(geom= "label",x = mu-2*s, y = 1100, label = "Mean - 2*s") +
  geom_segment(x = mu - 2*s, xend = mu+2*s, y = 800, yend = 800, color = "dodgerblue", size = 1) +
  coord_cartesian(xlim=c(-2.5, 8))+
  theme_bw())
```
:::

------------------------------------------------------------------------

## Measures of Variability


::: nonincremental
-   In addition to the sample standard deviation and the sample variance, there is the sample **interquartile range** (IQR):

$$
\mbox{IQR} = \mbox{Q}_3 - \mbox{Q}_1
$$
:::

- 25% of all observations are less than the *first quartile* Q1
- 25% of all observations are greater than the *third quartile* Q3

::: {.nonincremental .fragment}
Compute with R:

```{r}

IQR(biketown$Distance_Miles)

```

:::

------------------------------------------------------------------------

## Visualizing the IQR

::: nonincremental
-   In addition to the sample standard deviation and the sample variance, there is the sample **interquartile range** (IQR):

$$
\mbox{IQR} = \mbox{Q}_3 - \mbox{Q}_1
$$
:::

::: fragment
```{r}
quantile(biketown$Distance_Miles, c(0.25, 0.5, 0.75))
```

```{r fig.height = 2, out.width = "60%", fig.asp=.45, echo = F}
qs <- quantile(biketown$Distance_Miles, c(0.25, 0.5, 0.75))
(gg2 <- ggplot(biketown, aes(x = Distance_Miles)) +
    geom_histogram(bins = 50, color = "white") +
    geom_vline(xintercept = qs[1], color = "dodgerblue", linewidth = .5) +
    geom_vline(xintercept = qs[2], color = "dodgerblue", linewidth = .5) +
    geom_vline(xintercept = qs[3], color = "dodgerblue", linewidth = .5) +
    annotate("rect", xmin = mu-2*s, xmax =  mu+2*s, ymin = 0, ymax = 2250,
             alpha = 0, fill = "dodgerblue") +
    annotate("rect", xmin = qs[1], xmax =  qs[3], ymin = 0, ymax = 2250,
             alpha = .3, fill = "dodgerblue") +
    annotate(geom= "label", x = qs[1], y = 200, label = "Q1") +
    annotate(geom= "label", x = qs[2], y = 1100, label = "Median") +
    annotate(geom= "label", x = qs[3], y = 1100, label = "Q3") +
    coord_cartesian(xlim=c(-2.5, 8))+
    theme_bw())
```
:::


------------------------------------------------------------------------

## Comparing Measures of Variability

::: {.nonincremental}
-   **Q: Which is more robust to outliers, the IQR or $s$?**

::::: columns
::: {.column width="50%"}


```{r}
#| echo: false
gg1
```
:::

::: {.column width="50%"}

```{r}
#| echo: false
gg2
```

:::

::::

:::

<br>

-   **Q: Which is more commonly used, the IQR or $s$?**


# Summarizing Categorical Variables

------------------------------------------------------------------------

## New data set: Cambridge dogs


```{r}
dogs <- read.csv("https://data.cambridgema.gov/api/views/sckh-3xyx/rows.csv")
str(dogs)
```

------------------------------------------------------------------------

## Cambridge dogs data set

May want to focus on the dogs with the 5 most common names

```{r}
dogs <- read.csv("https://data.cambridgema.gov/api/views/sckh-3xyx/rows.csv")

# Useful wrangling that we will come back to
dogs_top5 <- dogs %>%
  mutate(Breed = case_when(Dog_Breed == "Mixed Breed" ~ "Mixed",
                           TRUE ~ "Single")) %>%
  filter(Dog_Name %in% c("Luna", "Charlie", "Lucy", "Cooper", "Rosie"))


head(dogs_top5)
```

------------------------------------------------------------------------

## Frequency Table

Distributions of categorical variables can be presented in tables and summarized in bar
charts.

::::: columns
::: {.column width="50%"}
```{r}
count(dogs_top5, Dog_Name)  # Handy function
```
:::

::: {.column width="50%" .fragment}
```{r}
ggplot(data = dogs_top5, 
    mapping = aes(x = Dog_Name)) +
  geom_bar()

```
:::
:::::

::: fragment
**Q: Why can't we use mean or standard deviation here?**
:::

------------------------------------------------------------------------

### Another `ggplot2` `geom`: `geom_col()`

If you have already aggregated the data, you will use `geom_col()` instead of `geom_bar()`.

```{r}
dog_counts <- count(dogs_top5, Dog_Name)
dog_counts
```

<br>

```{r}
#| output-location: column

ggplot(data = dog_counts,
       mapping = aes(x = Dog_Name,
                     y = n)) +
  geom_col()
```

------------------------------------------------------------------------

### Another `ggplot2` `geom`: `geom_col()`

And you can use `fct_reorder` to order bars by value

```{r}
dog_counts <- count(dogs_top5, Dog_Name)
dog_counts
```

<br>

```{r}
#| output-location: column
library(forcats)
ggplot(data = dog_counts,
       mapping = aes(x = fct_reorder(Dog_Name, n),
                     y = n)) +
  geom_col()
```

------------------------------------------------------------------------

## Contingency Table

To compare 2 categorical variables, we can use a contingency table


::::: columns
::: {.column width="50%"}

```{r}
# Using `count()` from dplyr
count(dogs_top5, Dog_Name, Breed)
```

<br>

::: fragment
```{r}
# More common presentation
table(dogs_top5$Dog_Name, dogs_top5$Breed)
```
:::
:::

::: {.column width="50%" .fragment}
```{r}
ggplot(data = dogs_top5, 
    mapping = aes(x = Dog_Name, fill = Breed)) +
  geom_bar(position = "dodge")

```
:::
:::::

------------------------------------------------------------------------

## Conditional Proportions

::::: columns
::: {.column width="50%"}
-   Beyond raw counts, we often summarize categorical data with **conditional** proportions.
    -   Especially when looking for relationships!
:::

::: {.column width="50%"}
```{r}
ggplot(data = dogs_top5, 
    mapping = aes(x = Dog_Name, fill = Breed)) +
  geom_bar(position = "fill")

```
:::
:::::

------------------------------------------------------------------------

## Conditional Proportions

::::: columns
::: {.column width="50%"}
```{r}
count(dogs_top5, Dog_Name, Breed)
```
:::

::: {.column width="50%"}
```{r}

count(dogs_top5, Dog_Name, Breed) %>%
  group_by(Dog_Name) %>%     ## Conditions on Dog Name
  mutate(prop = n / sum(n))  ## Adds/changes columns 

```
:::
:::::

We'll go over these data wrangling functions on Wednesday! 

------------------------------------------------------------------------

## Conditional Proportions

::::: columns
::: {.column width="50%"}
::: {.nonincremental}
```{r}
count(dogs_top5, Dog_Name, Breed) %>%
  group_by(Dog_Name) %>%     ## Conditions on Dog Name
  mutate(prop = n / sum(n))  ## Adds/changes columns 
```
:::
:::

::: {.column width="50%"}
::: {.nonincremental}
```{r}
count(dogs_top5, Dog_Name, Breed) %>%
  group_by(Breed) %>%     ## Conditions on Breed
  mutate(prop = n / sum(n))  ## Adds/changes columns 
```
:::
:::
:::::

How does the interpretation change based on which variable you condition on?

------------------------------------------------------------------------

## Reminders

-   The teaching team would love to see you in office hours!

-   Next time: 
    - We'll define **data wrangling** and
    - Learn to use more functions and methods to summarize and wrangle data
